using System.Collections.Generic;
using System.Net;

namespace NtFreX.Blog.Web
{
    public class VulnerabilityFactory
    {
        private readonly List<RequestSubject> subjects = new List<RequestSubject>();

        public RequestSubject[] GetAll() => subjects.ToArray();

        public void Create(string path, HttpStatusCode failureStatusCode)
        {
            Create("GET", path, failureStatusCode);
            Create("POST", path, failureStatusCode);
        }

        public void Create(string method, string path, HttpStatusCode failureStatusCode)
        {
            subjects.Add(RequestSubject.Create(method, path, "https", failureStatusCode));
            subjects.Add(RequestSubject.Create(method, path, "http", HttpStatusCode.TemporaryRedirect));
        }

        public void Create(string scheme, string method, string path, HttpStatusCode failureStatusCode)
        {
            subjects.Add(RequestSubject.Create(method, path, scheme, failureStatusCode));
        }
    }
}
